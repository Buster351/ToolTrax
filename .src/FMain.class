' Gambas class file


Public Sub Form_Open()

  If Gbl.OpenDataBase() Then 
    Label1.text = "Database Open"
  Endif
  
  Gbl.FillComboWithTable("users", ComboBox1)
End

Public Sub adduser_M_Click()

AddUser_F.ShowModal  
Gbl.FillComboWithTable("users", ComboBox1)
End

Public Sub addTool_M_Click()

  AddTool_F.ShowModal
  

End

Public Sub Supply_menu_Click()

  AddSupply_F.ShowModal

End

Public Sub ComboBox1_Click()

  

End

Public Sub ComboBox1_Change()

  Dim person As Result
  Dim tools As Result
  Dim supplies As Result
  Dim key As Integer
  Dim d As Variant
  
  If ComboBox1.Text.Len >= 1 Then
    
    person = Gbl.GetUserByName(ComboBox1.Text)
    Print person!id & "  " & person!name
    supplies = Gbl.GetSuppliesByUserId(person!id)
    TreeView1.Clear
    TreeView1.Add(0, "Tools Supplied To " & person!name)
      For Each supplies
        tools = Gbl.GetToolById(supplies!toolid)
        d = Date(supplies!date)
        TreeView1.Add(supplies!id, supplies!number & " " & tools!description & "  " & Format(d, "dd.mm.yyyy"), Gbl.GetPictureFromDB(tools))
      Next
  Endif       

End
